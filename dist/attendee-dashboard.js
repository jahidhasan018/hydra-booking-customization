var y=(_,a,p)=>new Promise((s,b)=>{var v=o=>{try{f(p.next(o))}catch(h){b(h)}},M=o=>{try{f(p.throw(o))}catch(h){b(h)}},f=o=>o.done?s(o.value):Promise.resolve(o.value).then(v,M);f((p=p.apply(_,a)).next())});import{_ as re,C as de,P as ce,r as W,c as u,o as m,a as T,b as e,d as _e,t as i,n as A,F as S,e as N,w as I,v as R,f as me,i as ge,g as x,h as z,j as ue,k as he,l as fe,m as pe,p as ve,q as ye,s as w,u as C,x as E,y as xe,z as be,A as we}from"./style-BLrjfZNT.js";const Me={name:"AttendeeDashboard",components:{ProfileModal:ce,CountdownTimer:de},setup(){var O;const _=ge("toast"),a=x(!1),p=x("bookings"),s=x("upcoming"),b=x([]);x([]);const v=z({}),M=z({}),f=z({show:!1,type:"",message:""}),o=x(((O=window.hbcAttendeeData)==null?void 0:O.logoutUrl)||"/wp-login.php?action=logout"),h=x(!1),D=x(new Set),J=[{id:"bookings",name:"My Bookings"},{id:"profile",name:"Profile"}],K=[{id:"upcoming",name:"Upcoming"},{id:"completed",name:"Completed"},{id:"cancelled",name:"Cancelled"}],g=(t,n)=>{_?_.showAlert(t,n):(f.show=!0,f.type=`alert-${t}`,f.message=n,setTimeout(()=>{f.show=!1},5e3))},q=()=>{f.show=!1},B=()=>y(this,null,function*(){try{a.value=!0;let n=(yield C.getBookings("all")).bookings||[];const l=new Date().toISOString().split("T")[0],d=new Date;s.value==="upcoming"?n=n.filter(r=>{const k=r.meeting_dates,L=new Date(k+" "+(r.start_time||"00:00:00")),c=r.attendee_status==="confirmed"||r.booking_status==="confirmed",j=r.attendee_status!=="completed"&&r.booking_status!=="completed",H=r.attendee_status!=="cancelled"&&r.attendee_status!=="canceled"&&r.booking_status!=="cancelled"&&r.booking_status!=="canceled";return L>d&&c&&j&&H}):s.value==="completed"?n=n.filter(r=>r.attendee_status==="completed"||r.booking_status==="completed"):s.value==="cancelled"&&(n=n.filter(r=>r.attendee_status==="cancelled"||r.attendee_status==="canceled"||r.booking_status==="cancelled"||r.booking_status==="canceled")),b.value=n}catch(t){g("error",E(t))}finally{a.value=!1}}),G=()=>y(this,null,function*(){try{const t=yield C.getProfile();t&&Object.assign(v,{first_name:t.first_name||"",last_name:t.last_name||"",email:t.email||"",display_name:t.name||"",phone:t.phone||"",timezone:t.timezone||""})}catch(t){console.error("Failed to load profile:",t),g("error",E(t))}}),Q=()=>y(this,null,function*(){try{const n=(yield C.getBookings("all")).bookings||[],l=new Date,d=n.length,r=n.filter(c=>{const j=c.meeting_dates;return new Date(j+" "+(c.start_time||"00:00:00"))>l&&(c.attendee_status==="confirmed"||c.attendee_status==="pending"||c.booking_status==="confirmed"||c.booking_status==="pending")}).length,k=n.filter(c=>c.attendee_status==="completed"||c.booking_status==="completed").length,L=n.filter(c=>c.attendee_status==="cancelled"||c.attendee_status==="canceled"||c.booking_status==="cancelled"||c.booking_status==="canceled").length;Object.assign(M,{total_bookings:d,upcoming_bookings:r,completed_bookings:k,cancelled_bookings:L})}catch(t){console.error("Failed to load stats:",t),g("error","Failed to load statistics")}}),X=()=>{h.value=!0},Y=t=>y(this,null,function*(){try{a.value=!0,yield C.updateProfile(t),Object.assign(v,t),h.value=!1,g("success","Profile updated successfully")}catch(n){g("error",E(n))}finally{a.value=!1}}),U=t=>{if(!t)return!1;try{const n=typeof t=="string"?JSON.parse(t):t;if(!n||typeof n!="object")return!1;const l=Object.keys(n);if(l.length===0)return!1;const d=n[l[0]];return!!(d.join_url||d.meeting_url)}catch(n){return!1}},V=t=>{if(!t)return null;try{const n=typeof t=="string"?JSON.parse(t):t;if(!n||typeof n!="object")return null;const l=Object.keys(n);if(l.length===0)return null;const d=n[l[0]];return d.join_url||d.meeting_url||null}catch(n){return null}},Z=t=>w(t)?t.status==="confirmed"||t.booking_status==="confirmed":(t.status==="confirmed"||t.booking_status==="confirmed")&&(U(t.meeting_locations)||t.meeting_id),P=t=>{if(w(t))return!0;const n=new Date,l=new Date(t.meeting_dates+" "+t.start_time),d=new Date(t.meeting_dates+" "+t.end_time),r=new Date(l.getTime()-5*60*1e3);return n>=r&&n<=d},$=t=>{if(w(t))return"btn-success animate-pulse";if(!P(t))return"btn-secondary opacity-50 cursor-not-allowed";const n=new Date,l=new Date(t.meeting_dates+" "+t.start_time),d=new Date(t.meeting_dates+" "+t.end_time);return n>=l&&n<=d?"btn-success animate-pulse":"btn-primary"},ee=t=>{if(w(t))return"Start Meeting";if(!P(t))return"Scheduled";const l=new Date,d=new Date(t.meeting_dates+" "+t.start_time),r=new Date(t.meeting_dates+" "+t.end_time);return l>=d&&l<=r?"Start Meeting":`Available in ${Math.ceil((d.getTime()-l.getTime())/6e4)}m`},te=t=>y(this,null,function*(){if(!D.value.has(t.id||t.booking_id))try{D.value.add(t.id||t.booking_id);const n=yield C.getMeetingLink(t.id||t.booking_id);if(console.log("API Response:",n),console.log("Response status:",n.status),console.log("Response meeting_url:",n.meeting_url),n.status&&n.meeting_url){let l=n.meeting_url.toString().trim();l.startsWith('"')&&l.endsWith('"')&&(l=l.slice(1,-1)),l.startsWith("'")&&l.endsWith("'")&&(l=l.slice(1,-1)),console.log("Cleaned URL:",l),console.log("About to navigate to:",l),window.location.href=l}else{const l=V(t.meeting_locations);l?(window.open(l,"_blank","noopener,noreferrer"),g("success","Meeting opened in new tab")):w(t)?g("info","Test mode: Meeting link would be available here in production."):g("error","Meeting link not available. Please contact support.")}}catch(n){console.error("Error getting meeting link:",n),w(t)?g("info","Test mode: Meeting access would be available here in production."):g("error","Failed to get meeting link. Please try again.")}finally{D.value.delete(t.id||t.booking_id)}}),se=()=>y(this,null,function*(){a.value=!0;try{yield Promise.all([B(),G(),Q()])}catch(t){g("error","Failed to load dashboard data")}finally{a.value=!1}});ue(p,t=>{t==="bookings"&&B()});const oe=()=>y(this,null,function*(){if(confirm("Are you sure you want to logout?"))try{const n=yield(yield fetch(window.hbcAttendeeData.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`action=hbc_logout&nonce=${window.hbcAttendeeData.logoutNonce}`})).json();n.success?window.location.href=n.data.login_url:g("error","Logout failed. Please try again.")}catch(t){console.error("Error:",t),g("error","Logout failed. Please try again.")}}),ne=t=>{const n=new Date;return new Date(t.meeting_dates+" "+t.start_time)>n},ae=t=>{console.log("Meeting expired:",t),B()},ie=(t,n)=>{console.log("Meeting starting soon:",t,n)},le=(t,n)=>{console.log("Meeting approaching:",t,n)};return he(se),{isLoading:a,activeTab:p,currentFilter:s,bookings:b,profile:v,stats:M,alert:f,showProfileModal:h,tabs:J,bookingFilters:K,logoutUrl:o,showAlert:g,clearAlert:q,loadBookings:B,openProfileModal:X,updateProfile:Y,handleLogout:oe,hasJoinLink:U,getJoinLink:V,canShowMeetingButton:Z,isMeetingAvailable:P,getMeetingButtonClass:$,getMeetingButtonText:ee,handleMeetingAction:te,isTestModeActiveForBooking:w,isUpcomingMeeting:ne,onMeetingExpired:ae,onMeetingUrgent:ie,onMeetingWarning:le,formatDateTime:ye,getStatusClass:ve,getStatusText:pe,__:fe}}},Te={class:"min-h-screen bg-gray-50 py-8"},ke={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},Ae={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Ce={class:"mb-8 hbc-dashboard-header"},Be={class:"hbc-header-content"},De={class:"hbc-header-text"},Pe={class:"text-3xl font-bold text-gray-900"},Le={class:"mt-2 text-gray-600"},je={class:"hbc-header-actions"},Se={class:"flex justify-between items-center"},Ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},ze={class:"card"},Ee={class:"card-body"},Fe={class:"flex items-center"},Ue={class:"ml-4"},Ve={class:"text-2xl font-semibold text-gray-900"},Oe={class:"text-sm text-gray-600"},He={class:"card"},We={class:"card-body"},Ie={class:"flex items-center"},Re={class:"ml-4"},Je={class:"text-2xl font-semibold text-gray-900"},Ke={class:"text-sm text-gray-600"},qe={class:"card"},Ge={class:"card-body"},Qe={class:"flex items-center"},Xe={class:"ml-4"},Ye={class:"text-2xl font-semibold text-gray-900"},Ze={class:"text-sm text-gray-600"},$e={class:"card"},et={class:"card-body"},tt={class:"flex items-center"},st={class:"ml-4"},ot={class:"text-2xl font-semibold text-gray-900"},nt={class:"text-sm text-gray-600"},at={class:"tab-nav mb-6"},it={class:"flex space-x-8"},lt=["onClick"],rt={key:1,class:"mb-6"},dt={class:"flex space-x-4"},ct=["onClick"],_t={class:"bg-white rounded-lg shadow"},mt={class:"p-6"},gt={class:"flex justify-between items-center mb-6"},ut={class:"text-lg font-medium text-gray-900"},ht={key:0,class:"text-center py-12"},ft={class:"mt-2 text-sm font-medium text-gray-900"},pt={class:"mt-1 text-sm text-gray-500"},vt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},yt={class:"px-6 py-4 border-b border-gray-100 flex justify-between items-center"},xt={class:"text-lg font-semibold text-gray-900 truncate"},bt={key:0,class:"px-6 py-4 border-b border-gray-100"},wt={class:"px-6 py-4 space-y-3"},Mt={class:"text-sm font-medium text-gray-700"},Tt={class:"text-sm text-gray-900 truncate"},kt={class:"text-sm font-medium text-gray-700"},At={class:"text-sm text-gray-600 truncate"},Ct={class:"text-sm font-medium text-gray-700"},Bt={class:"text-sm text-gray-600"},Dt={class:"text-sm font-medium text-gray-700"},Pt={class:"text-sm text-gray-600"},Lt={class:"px-6 py-4 border-t border-gray-100"},jt=["onClick","disabled"],St={class:"p-6"},Nt={class:"flex justify-between items-center mb-6"},zt={class:"text-lg font-medium text-gray-900"},Et={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ft={class:"form-label"},Ut={class:"text-gray-700"},Vt={class:"form-label"},Ot={class:"text-gray-700"},Ht={class:"form-label"},Wt={class:"text-gray-700"},It={class:"form-label"},Rt={class:"text-gray-700"},Jt={class:"md:col-span-2"},Kt={class:"form-label"},qt={class:"text-gray-700"};function Gt(_,a,p,s,b,v){const M=W("CountdownTimer"),f=W("ProfileModal");return m(),u("div",Te,[s.isLoading?(m(),u("div",ke,a[5]||(a[5]=[e("div",{class:"bg-white p-6 rounded-lg shadow-lg"},[e("div",{class:"flex items-center space-x-3"},[e("div",{class:"loading-spinner"}),e("span",{class:"text-gray-700"},"Loading...")])],-1)]))):T("",!0),e("div",Ae,[e("div",Ce,[e("div",Be,[e("div",De,[e("h1",Pe,i(s.__("attendee_dashboard")),1),e("p",Le,i(s.__("manage_bookings_profile")),1)]),e("div",je,[e("button",{onClick:a[0]||(a[0]=(...o)=>s.handleLogout&&s.handleLogout(...o)),class:"hbc-logout-btn"},i(s.__("logout")),1)])])]),s.alert.show?(m(),u("div",{key:0,class:A([s.alert.type,"mb-6 animate-fade-in"])},[e("div",Se,[e("span",null,i(s.alert.message),1),e("button",{onClick:a[1]||(a[1]=(...o)=>s.clearAlert&&s.clearAlert(...o)),class:"text-lg leading-none hover:opacity-75"},"×")])],2)):T("",!0),e("div",Ne,[e("div",ze,[e("div",Ee,[e("div",Fe,[a[6]||(a[6]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-primary-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])])],-1)),e("div",Ue,[e("p",Ve,i(s.stats.total_bookings||0),1),e("p",Oe,i(s.__("total_bookings")),1)])])])]),e("div",He,[e("div",We,[e("div",Ie,[a[7]||(a[7]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-success-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-success-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})])])],-1)),e("div",Re,[e("p",Je,i(s.stats.upcoming_bookings||0),1),e("p",Ke,i(s.__("upcoming")),1)])])])]),e("div",qe,[e("div",Ge,[e("div",Qe,[a[8]||(a[8]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-warning-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-warning-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})])])],-1)),e("div",Xe,[e("p",Ye,i(s.stats.completed_bookings||0),1),e("p",Ze,i(s.__("completed")),1)])])])]),e("div",$e,[e("div",et,[e("div",tt,[a[9]||(a[9]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)),e("div",st,[e("p",ot,i(s.stats.cancelled_bookings||0),1),e("p",nt,i(s.__("cancelled")),1)])])])])]),e("div",at,[e("nav",it,[(m(!0),u(S,null,N(s.tabs,o=>(m(),u("button",{key:o.id,onClick:h=>s.activeTab=o.id,class:A(["py-2 px-1 border-b-2 font-medium text-sm transition-colors duration-200",s.activeTab===o.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},i(s.__(o.name.toLowerCase().replace(" ","_"))),11,lt))),128))])]),s.activeTab==="bookings"?(m(),u("div",rt,[e("div",dt,[(m(!0),u(S,null,N(s.bookingFilters,o=>(m(),u("button",{key:o.id,onClick:h=>{s.currentFilter=o.id,s.loadBookings()},class:A(["px-4 py-2 rounded-lg font-medium text-sm transition-colors duration-200",s.currentFilter===o.id?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},i(o.name),11,ct))),128))])])):T("",!0),e("div",_t,[I(e("div",mt,[e("div",gt,[e("h3",ut,i(s.__("my_bookings")),1),e("button",{onClick:a[2]||(a[2]=(...o)=>s.loadBookings&&s.loadBookings(...o)),class:"btn-primary"},[a[10]||(a[10]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"})],-1)),me(" "+i(s.__("refresh")),1)])]),s.bookings.length===0?(m(),u("div",ht,[a[11]||(a[11]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3a1 1 0 011-1h6a1 1 0 011 1v4m-6 0h6m-6 0V7a1 1 0 00-1 1v9a2 2 0 002 2h6a2 2 0 002-2V8a1 1 0 00-1-1V7"})],-1)),e("h3",ft,i(s.__("no_bookings")),1),e("p",pt,i(s.__("no_bookings_message")),1)])):(m(),u("div",vt,[(m(!0),u(S,null,N(s.bookings,o=>(m(),u("div",{key:o.id||o.booking_id,class:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 overflow-hidden"},[e("div",yt,[e("h4",xt,i(o.title||o.meeting_title),1),e("span",{class:A([s.getStatusClass(o.status||o.booking_status),"badge text-xs px-2 py-1 rounded-full"])},i(s.getStatusText(o.status||o.booking_status)),3)]),s.currentFilter==="upcoming"&&s.isUpcomingMeeting(o)?(m(),u("div",bt,[xe(M,{"meeting-date":o.meeting_dates,"start-time":o.start_time,onExpired:h=>s.onMeetingExpired(o),onUrgent:h=>s.onMeetingUrgent(o),onWarning:h=>s.onMeetingWarning(o)},null,8,["meeting-date","start-time","onExpired","onUrgent","onWarning"])])):T("",!0),e("div",wt,[e("div",null,[e("p",Mt,i(s.__("host")),1),e("p",Tt,i((o.host_first_name+" "+o.host_last_name).trim()||o.host_name||"N/A"),1)]),e("div",null,[e("p",kt,i(s.__("email")),1),e("p",At,i(o.host_email||"N/A"),1)]),e("div",null,[e("p",Ct,i(s.__("duration")),1),e("p",Bt,i(o.duration||"N/A"),1)]),e("div",null,[e("p",Dt,i(s.__("date_time")),1),e("p",Pt,i(s.formatDateTime(o.meeting_dates,o.start_time)),1)])]),e("div",Lt,[s.canShowMeetingButton(o)?(m(),u("button",{key:0,onClick:h=>s.handleMeetingAction(o),class:A(s.getMeetingButtonClass(o)+" w-full"),disabled:!s.isMeetingAvailable(o)&&!s.isTestModeActiveForBooking(o)},i(s.getMeetingButtonText(o)),11,jt)):T("",!0)])]))),128))]))],512),[[R,s.activeTab==="bookings"]]),I(e("div",St,[e("div",Nt,[e("h3",zt,i(s.__("profile_settings")),1),e("button",{onClick:a[3]||(a[3]=(...o)=>s.openProfileModal&&s.openProfileModal(...o)),class:"btn-primary"},i(s.__("edit_profile")),1)]),e("div",Et,[e("div",null,[e("label",Ft,i(s.__("first_name")),1),e("p",Ut,i(s.profile.first_name||"Not set"),1)]),e("div",null,[e("label",Vt,i(s.__("last_name")),1),e("p",Ot,i(s.profile.last_name||"Not set"),1)]),e("div",null,[e("label",Ht,i(s.__("email")),1),e("p",Wt,i(s.profile.email||"Not set"),1)]),e("div",null,[e("label",It,i(s.__("phone")),1),e("p",Rt,i(s.profile.phone||"Not set"),1)]),e("div",Jt,[e("label",Kt,i(s.__("timezone")),1),e("p",qt,i(s.profile.timezone||"Not set"),1)])])],512),[[R,s.activeTab==="profile"]])])]),s.showProfileModal?(m(),_e(f,{key:1,profile:s.profile,onClose:a[4]||(a[4]=o=>s.showProfileModal=!1),onSave:s.updateProfile},null,8,["profile","onSave"])):T("",!0)])}const Qt=re(Me,[["render",Gt]]);function F(){const _=document.getElementById("attendee-dashboard-app");if(_&&!_.__vue_app__)try{const a=be(Qt);a.use(we),a.config.errorHandler=(s,b,v)=>{console.error("Vue Attendee Dashboard error:",s,v),_.innerHTML=`
          <div style="padding: 20px; background: #fee; border: 1px solid #fcc; border-radius: 4px; color: #c33;">
            <h3>Dashboard Error</h3>
            <p>There was an error loading the dashboard. Please refresh the page or contact support.</p>
            <details style="margin-top: 10px;">
              <summary>Error Details</summary>
              <pre style="margin-top: 10px; font-size: 12px;">${s.message}</pre>
            </details>
          </div>
        `},a.mount(_),_.__vue_app__=a,_.style.display="block";const p=document.getElementById("hbc-loading-state");p&&(p.style.display="none")}catch(a){console.error("Failed to mount Attendee Dashboard:",a),_.innerHTML=`
        <div style="padding: 20px; background: #fee; border: 1px solid #fcc; border-radius: 4px; color: #c33;">
          <h3>Dashboard Unavailable</h3>
          <p>The dashboard could not be loaded. Please refresh the page or contact support.</p>
          <button onclick="location.reload()" style="margin-top: 10px; padding: 8px 16px; background: #007cba; color: white; border: none; border-radius: 4px; cursor: pointer;">
            Refresh Page
          </button>
        </div>
      `}else _&&_.__vue_app__||console.error("Attendee Dashboard container not found")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",F):F();setTimeout(F,100);
